{"version":3,"file":"maptastic.js","sources":["../src/maptastic.js"],"sourcesContent":["import { solve } from 'numeric';\n\n\nfunction Maptastic(config) {\n\n  var getProp = function (cfg, key, defaultVal) {\n    if (cfg && cfg.hasOwnProperty(key) && (cfg[key] !== null)) {\n      return cfg[key];\n    } else {\n      return defaultVal;\n    }\n  };\n\n  var showLayerNames = getProp(config, 'labels', true);\n  var showCrosshairs = getProp(config, 'crosshairs', false);\n  var showScreenBounds = getProp(config, 'screenbounds', false);\n  var autoSave = getProp(config, 'autoSave', true);\n  var autoLoad = getProp(config, 'autoLoad', true);\n  var layerList = getProp(config, 'layers', []);\n  var layoutChangeListener = getProp(config, 'onchange', function () {\n  });\n  var localStorageKey = 'maptastic.layers';\n\n  var canvas = null;\n  var context = null;\n\n  var layers = [];\n\n  var configActive = false;\n\n  var dragging = false;\n  var dragOffset = [];\n\n  var selectedLayer = null;\n  var selectedPoint = null;\n  var selectionRadius = 20;\n  var hoveringPoint = null;\n  var hoveringLayer = null;\n  var dragOperation = 'move';\n  var isLayerSoloed = false;\n\n  var mousePosition = [];\n  var mouseDelta = [];\n  var mouseDownPoint = [];\n\n  // Compute linear distance.\n  var distanceTo = function (x1, y1, x2, y2) {\n    return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n  };\n\n  var pointInTriangle = function (point, a, b, c) {\n    var s = a[1] * c[0] - a[0] * c[1] + (c[1] - a[1]) * point[0] + (a[0] - c[0]) * point[1];\n    var t = a[0] * b[1] - a[1] * b[0] + (a[1] - b[1]) * point[0] + (b[0] - a[0]) * point[1];\n\n    if ((s < 0) != (t < 0)) {\n      return false;\n    }\n\n    var A = -b[1] * c[0] + a[1] * (c[0] - b[0]) + a[0] * (b[1] - c[1]) + b[0] * c[1];\n    if (A < 0.0) {\n      s = -s;\n      t = -t;\n      A = -A;\n    }\n\n    return s > 0 && t > 0 && (s + t) < A;\n  };\n\n  // determine if a point is inside a layer quad.\n  var pointInLayer = function (point, layer) {\n    var a = pointInTriangle(point, layer.targetPoints[0], layer.targetPoints[1], layer.targetPoints[2]);\n    var b = pointInTriangle(point, layer.targetPoints[3], layer.targetPoints[0], layer.targetPoints[2]);\n    return a || b;\n  };\n\n  var notifyChangeListener = function () {\n    layoutChangeListener();\n  };\n\n  var draw = function () {\n    if (!configActive) {\n      return;\n    }\n\n    context.strokeStyle = 'red';\n    context.lineWidth = 2;\n    context.clearRect(0, 0, canvas.width, canvas.height);\n\n    for (var i = 0; i < layers.length; i++) {\n\n      if (layers[i].visible) {\n        layers[i].element.style.visibility = 'visible';\n\n        // Draw layer rectangles.\n        context.beginPath();\n        if (layers[i] === hoveringLayer) {\n          context.strokeStyle = 'red';\n        } else if (layers[i] === selectedLayer) {\n          context.strokeStyle = 'red';\n        } else {\n          context.strokeStyle = 'white';\n        }\n        context.moveTo(layers[i].targetPoints[0][0], layers[i].targetPoints[0][1]);\n        for (var p = 0; p < layers[i].targetPoints.length; p++) {\n          context.lineTo(layers[i].targetPoints[p][0], layers[i].targetPoints[p][1]);\n        }\n        context.lineTo(layers[i].targetPoints[3][0], layers[i].targetPoints[3][1]);\n        context.closePath();\n        context.stroke();\n\n        // Draw corner points.\n        var centerPoint = [0, 0];\n        for (var p = 0; p < layers[i].targetPoints.length; p++) {\n\n          if (layers[i].targetPoints[p] === hoveringPoint) {\n            context.strokeStyle = 'red';\n          } else if (layers[i].targetPoints[p] === selectedPoint) {\n            context.strokeStyle = 'red';\n          } else {\n            context.strokeStyle = 'white';\n          }\n\n          centerPoint[0] += layers[i].targetPoints[p][0];\n          centerPoint[1] += layers[i].targetPoints[p][1];\n\n          context.beginPath();\n          context.arc(layers[i].targetPoints[p][0], layers[i].targetPoints[p][1],\n            selectionRadius / 2, 0, 2 * Math.PI, false);\n          context.stroke();\n        }\n\n        // Find the average of the corner locations for an approximate center.\n        centerPoint[0] /= 4;\n        centerPoint[1] /= 4;\n\n\n        if (showLayerNames) {\n          // Draw the element ID in the center of the quad for reference.\n          var label = layers[i].element.id.toUpperCase();\n          context.font = '16px sans-serif';\n          context.textAlign = 'center';\n          var metrics = context.measureText(label);\n          var size = [metrics.width + 8, 16 + 16];\n          context.fillStyle = 'white';\n          context.fillRect(centerPoint[0] - size[0] / 2, centerPoint[1] - size[1] + 8, size[0], size[1]);\n          context.fillStyle = 'black';\n          context.fillText(label, centerPoint[0], centerPoint[1]);\n        }\n      } else {\n        layers[i].element.style.visibility = 'hidden';\n      }\n    }\n\n    // Draw mouse crosshairs\n    if (showCrosshairs) {\n      context.strokeStyle = 'yellow';\n      context.lineWidth = 1;\n\n      context.beginPath();\n\n      context.moveTo(mousePosition[0], 0);\n      context.lineTo(mousePosition[0], canvas.height);\n\n      context.moveTo(0, mousePosition[1]);\n      context.lineTo(canvas.width, mousePosition[1]);\n\n      context.stroke();\n    }\n\n    if (showScreenBounds) {\n\n      context.fillStyle = 'black';\n      context.lineWidth = 4;\n      context.fillRect(0, 0, canvas.width, canvas.height);\n\n      context.strokeStyle = '#909090';\n      context.beginPath();\n      var stepX = canvas.width / 10;\n      var stepY = canvas.height / 10;\n\n      for (var i = 0; i < 10; i++) {\n        context.moveTo(i * stepX, 0);\n        context.lineTo(i * stepX, canvas.height);\n\n        context.moveTo(0, i * stepY);\n        context.lineTo(canvas.width, i * stepY);\n      }\n      context.stroke();\n\n      context.strokeStyle = 'white';\n      context.strokeRect(2, 2, canvas.width - 4, canvas.height - 4);\n\n      var fontSize = Math.round(stepY * 0.6);\n      context.font = fontSize + 'px mono,sans-serif';\n      context.fillRect(stepX * 2 + 2, stepY * 3 + 2, canvas.width - stepX * 4 - 4, canvas.height - stepY * 6 - 4);\n      context.fillStyle = 'white';\n      context.fontSize = 20;\n      context.fillText(canvas.width + ' x ' + canvas.height, canvas.width / 2, canvas.height / 2 + (fontSize * 0.75));\n      context.fillText('display size', canvas.width / 2, canvas.height / 2 - (fontSize * 0.75));\n    }\n  };\n\n  var swapLayerPoints = function (layerPoints, index1, index2) {\n    var tx = layerPoints[index1][0];\n    var ty = layerPoints[index1][1];\n    layerPoints[index1][0] = layerPoints[index2][0];\n    layerPoints[index1][1] = layerPoints[index2][1];\n    layerPoints[index2][0] = tx;\n    layerPoints[index2][1] = ty;\n  };\n\n  var init = function () {\n    canvas = document.createElement('canvas');\n\n    canvas.style.display = 'none';\n    canvas.style.position = 'fixed';\n    canvas.style.top = '0px';\n    canvas.style.left = '0px';\n    canvas.style.zIndex = '1000000';\n\n    context = canvas.getContext('2d');\n\n    document.body.appendChild(canvas);\n\n    window.addEventListener('resize', resize);\n\n    // UI events\n    window.addEventListener('mousemove', mouseMove);\n    window.addEventListener('mouseup', mouseUp);\n    window.addEventListener('mousedown', mouseDown);\n    window.addEventListener('keydown', keyDown);\n\n    resize();\n  };\n\n  var rotateLayer = function (layer, angle) {\n    var s = Math.sin(angle);\n    var c = Math.cos(angle);\n\n    var centerPoint = [0, 0];\n    for (var p = 0; p < layer.targetPoints.length; p++) {\n      centerPoint[0] += layer.targetPoints[p][0];\n      centerPoint[1] += layer.targetPoints[p][1];\n    }\n\n    centerPoint[0] /= 4;\n    centerPoint[1] /= 4;\n\n    for (var p = 0; p < layer.targetPoints.length; p++) {\n      var px = layer.targetPoints[p][0] - centerPoint[0];\n      var py = layer.targetPoints[p][1] - centerPoint[1];\n\n      layer.targetPoints[p][0] = (px * c) - (py * s) + centerPoint[0];\n      layer.targetPoints[p][1] = (px * s) + (py * c) + centerPoint[1];\n    }\n  };\n\n  var scaleLayer = function (layer, scale) {\n\n    var centerPoint = [0, 0];\n    for (var p = 0; p < layer.targetPoints.length; p++) {\n      centerPoint[0] += layer.targetPoints[p][0];\n      centerPoint[1] += layer.targetPoints[p][1];\n    }\n\n    centerPoint[0] /= 4;\n    centerPoint[1] /= 4;\n\n    for (var p = 0; p < layer.targetPoints.length; p++) {\n      var px = layer.targetPoints[p][0] - centerPoint[0];\n      var py = layer.targetPoints[p][1] - centerPoint[1];\n\n      layer.targetPoints[p][0] = (px * scale) + centerPoint[0];\n      layer.targetPoints[p][1] = (py * scale) + centerPoint[1];\n    }\n  };\n\n  var keyDown = function (event) {\n    if (!configActive) {\n      if (event.keyCode == 32 && event.shiftKey) {\n        setConfigEnabled(true);\n        return;\n      } else {\n        return;\n      }\n    }\n\n    var key = event.keyCode;\n\n    var increment = event.shiftKey ? 10 : 1;\n    var dirty = false;\n    var delta = [0, 0];\n\n    switch (key) {\n\n      case 32: // spacebar\n        if (event.shiftKey) {\n          setConfigEnabled(false);\n          return;\n        }\n        break;\n\n      case 37: // left arrow\n        delta[0] -= increment;\n        break;\n\n      case 38: // up arrow\n        delta[1] -= increment;\n        break;\n\n      case 39: // right arrow\n        delta[0] += increment;\n        break;\n\n      case 40: // down arrow\n        delta[1] += increment;\n        break;\n\n      case 67: // c key, toggle crosshairs\n        showCrosshairs = !showCrosshairs;\n        dirty = true;\n        break;\n\n      case 83: // s key, solo/unsolo quads\n        if (!isLayerSoloed) {\n\n          if (selectedLayer != null) {\n            for (var i = 0; i < layers.length; i++) {\n              layers[i].visible = false;\n            }\n            selectedLayer.visible = true;\n            dirty = true;\n            isLayerSoloed = true;\n          }\n        } else {\n          for (var i = 0; i < layers.length; i++) {\n            layers[i].visible = true;\n          }\n          isLayerSoloed = false;\n          dirty = true;\n\n        }\n        break;\n\n      case 66: // b key, toggle projector bounds rectangle.\n        showScreenBounds = !showScreenBounds;\n        draw();\n        break;\n\n      case 72: // h key, flip horizontal.\n        if (selectedLayer) {\n          swapLayerPoints(selectedLayer.sourcePoints, 0, 1);\n          swapLayerPoints(selectedLayer.sourcePoints, 3, 2);\n          updateTransform();\n          draw();\n        }\n        break;\n\n      case 86: // v key, flip vertical.\n        if (selectedLayer) {\n          swapLayerPoints(selectedLayer.sourcePoints, 0, 3);\n          swapLayerPoints(selectedLayer.sourcePoints, 1, 2);\n          updateTransform();\n          draw();\n        }\n        break;\n\n      case 82: // r key, rotate 90 degrees.\n        if (selectedLayer) {\n          rotateLayer(selectedLayer, Math.PI / 2);\n          //rotateLayer(selectedLayer, 0.002);\n          updateTransform();\n          draw();\n        }\n        break;\n    }\n\n    // if a layer or point is selected, add the delta amounts (set above via arrow keys)\n    if (!showScreenBounds) {\n      if (selectedPoint) {\n        selectedPoint[0] += delta[0];\n        selectedPoint[1] += delta[1];\n        dirty = true;\n      } else if (selectedLayer) {\n        if (event.altKey == true) {\n          rotateLayer(selectedLayer, delta[0] * 0.01);\n          scaleLayer(selectedLayer, (delta[1] * -0.005) + 1.0);\n        } else {\n          for (var i = 0; i < selectedLayer.targetPoints.length; i++) {\n            selectedLayer.targetPoints[i][0] += delta[0];\n            selectedLayer.targetPoints[i][1] += delta[1];\n          }\n        }\n        dirty = true;\n      }\n    }\n\n    // update the transform and redraw if needed\n    if (dirty) {\n      updateTransform();\n      draw();\n      if (autoSave) {\n        saveSettings();\n      }\n      notifyChangeListener();\n    }\n  };\n\n  var mouseMove = function (event) {\n    if (!configActive) {\n      return;\n    }\n\n    event.preventDefault();\n\n    mouseDelta[0] = event.clientX - mousePosition[0];\n    mouseDelta[1] = event.clientY - mousePosition[1];\n\n    mousePosition[0] = event.clientX;\n    mousePosition[1] = event.clientY;\n\n    if (dragging) {\n\n      var scale = event.shiftKey ? 0.1 : 1;\n\n      if (selectedPoint) {\n        selectedPoint[0] += mouseDelta[0] * scale;\n        selectedPoint[1] += mouseDelta[1] * scale;\n      } else if (selectedLayer) {\n\n        // Alt-drag to rotate and scale\n        if (event.altKey == true) {\n          rotateLayer(selectedLayer, mouseDelta[0] * (0.01 * scale));\n          scaleLayer(selectedLayer, (mouseDelta[1] * (-0.005 * scale)) + 1.0);\n        } else {\n          for (var i = 0; i < selectedLayer.targetPoints.length; i++) {\n            selectedLayer.targetPoints[i][0] += mouseDelta[0] * scale;\n            selectedLayer.targetPoints[i][1] += mouseDelta[1] * scale;\n          }\n        }\n      }\n\n      updateTransform();\n      if (autoSave) {\n        saveSettings();\n      }\n      draw();\n      notifyChangeListener();\n\n    } else {\n      var dirty = false;\n\n      canvas.style.cursor = 'default';\n      var mouseX = event.clientX;\n      var mouseY = event.clientY;\n\n      var previousState = (hoveringPoint != null);\n      var previousLayer = (hoveringLayer != null);\n\n      hoveringPoint = null;\n\n      for (var i = 0; i < layers.length; i++) {\n        var layer = layers[i];\n        if (layer.visible) {\n          for (var p = 0; p < layer.targetPoints.length; p++) {\n            var point = layer.targetPoints[p];\n            if (distanceTo(point[0], point[1], mouseX, mouseY) < selectionRadius) {\n              canvas.style.cursor = 'pointer';\n              hoveringPoint = point;\n              break;\n            }\n          }\n        }\n      }\n\n      hoveringLayer = null;\n      for (var i = 0; i < layers.length; i++) {\n        if (layers[i].visible && pointInLayer(mousePosition, layers[i])) {\n          hoveringLayer = layers[i];\n          break;\n        }\n      }\n\n      if (showCrosshairs ||\n        (previousState != (hoveringPoint != null)) ||\n        (previousLayer != (hoveringLayer != null))\n      ) {\n        draw();\n      }\n    }\n  };\n\n  var mouseUp = function (event) {\n    if (!configActive) {\n      return;\n    }\n    event.preventDefault();\n\n    dragging = false;\n  };\n\n  var mouseDown = function (event) {\n    if (!configActive || showScreenBounds) {\n      return;\n    }\n    event.preventDefault();\n\n    hoveringPoint = null;\n\n    if (hoveringLayer) {\n      selectedLayer = hoveringLayer;\n      dragging = true;\n    } else {\n      selectedLayer = null;\n    }\n\n    selectedPoint = null;\n\n    var mouseX = event.clientX;\n    var mouseY = event.clientY;\n\n    mouseDownPoint[0] = mouseX;\n    mouseDownPoint[1] = mouseY;\n\n    for (var i = 0; i < layers.length; i++) {\n      var layer = layers[i];\n      for (var p = 0; p < layer.targetPoints.length; p++) {\n        var point = layer.targetPoints[p];\n        if (distanceTo(point[0], point[1], mouseX, mouseY) < selectionRadius) {\n          selectedLayer = layer;\n          selectedPoint = point;\n          dragging = true;\n          dragOffset[0] = event.clientX - point[0];\n          dragOffset[1] = event.clientY - point[1];\n          //draw();\n          break;\n        }\n      }\n    }\n    draw();\n    return false;\n  };\n\n  var addLayer = function (target, targetPoints) {\n\n    var element;\n\n    if (typeof (target) == 'string') {\n      element = document.getElementById(target);\n      if (!element) {\n        throw('Maptastic: No element found with id: ' + target);\n      }\n    } else if (target instanceof HTMLElement) {\n      element = target;\n    }\n\n    var exists = false;\n    for (var n = 0; n < layers.length; n++) {\n      if (layers[n].element.id == element.id) {\n        layers[n].targetPoints = clonePoints(layout[i].targetPoints);\n        exists = true;\n      }\n    }\n\n    var offsetX = element.offsetLeft;\n    var offsetY = element.offsetTop;\n\n    element.style.position = 'fixed';\n    element.style.display = 'block';\n    element.style.top = '0px';\n    element.style.left = '0px';\n    element.style.padding = '0px';\n    element.style.margin = '0px';\n\n    var layer = {\n      'visible': true,\n      'element': element,\n      'width': element.clientWidth,\n      'height': element.clientHeight,\n      'sourcePoints': [],\n      'targetPoints': []\n    };\n    layer.sourcePoints.push([0, 0], [layer.width, 0], [layer.width, layer.height], [0, layer.height]);\n\n    if (targetPoints) {\n      layer.targetPoints = clonePoints(targetPoints);\n    } else {\n      layer.targetPoints.push([0, 0], [layer.width, 0], [layer.width, layer.height], [0, layer.height]);\n      for (var i = 0; i < layer.targetPoints.length; i++) {\n        layer.targetPoints[i][0] += offsetX;\n        layer.targetPoints[i][1] += offsetY;\n      }\n    }\n\n    layers.push(layer);\n\n    updateTransform();\n  };\n\n  var saveSettings = function () {\n    localStorage.setItem(localStorageKey, JSON.stringify(getLayout(layers)));\n  };\n\n  var loadSettings = function () {\n    if (localStorage.getItem(localStorageKey)) {\n      var data = JSON.parse(localStorage.getItem(localStorageKey));\n\n      for (var i = 0; i < data.length; i++) {\n        for (var n = 0; n < layers.length; n++) {\n          if (layers[n].element.id == data[i].id) {\n            layers[n].targetPoints = clonePoints(data[i].targetPoints);\n            layers[n].sourcePoints = clonePoints(data[i].sourcePoints);\n          }\n        }\n      }\n      updateTransform();\n    }\n  };\n\n  var updateTransform = function () {\n    var transform = ['', '-webkit-', '-moz-', '-ms-', '-o-'].reduce(function (p, v) {\n      return v + 'transform' in document.body.style ? v : p;\n    }) + 'transform';\n    for (var l = 0; l < layers.length; l++) {\n\n      for (var a = [], b = [], i = 0, n = layers[l].sourcePoints.length; i < n; ++i) {\n        var s = layers[l].sourcePoints[i], t = layers[l].targetPoints[i];\n        a.push([s[0], s[1], 1, 0, 0, 0, -s[0] * t[0], -s[1] * t[0]]), b.push(t[0]);\n        a.push([0, 0, 0, s[0], s[1], 1, -s[0] * t[1], -s[1] * t[1]]), b.push(t[1]);\n      }\n\n      var X = solve(a, b, true);\n      var matrix = [\n        X[0], X[3], 0, X[6],\n        X[1], X[4], 0, X[7],\n        0, 0, 1, 0,\n        X[2], X[5], 0, 1\n      ];\n\n      layers[l].element.style[transform] = 'matrix3d(' + matrix.join(',') + ')';\n      layers[l].element.style[transform + '-origin'] = '0px 0px 0px';\n    }\n  };\n\n  var setConfigEnabled = function (enabled) {\n    configActive = enabled;\n    canvas.style.display = enabled ? 'block' : 'none';\n\n    if (!enabled) {\n      selectedPoint = null;\n      selectedLayer = null;\n      dragging = false;\n      showScreenBounds = false;\n    } else {\n      draw();\n    }\n  };\n\n  var clonePoints = function (points) {\n    var clone = [];\n    for (var p = 0; p < points.length; p++) {\n      clone.push(points[p].slice(0, 2));\n    }\n    return clone;\n  };\n\n  var resize = function () {\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n\n    draw();\n  };\n\n  var getLayout = function () {\n    var layout = [];\n    for (var i = 0; i < layers.length; i++) {\n      layout.push({\n        'id': layers[i].element.id,\n        'targetPoints': clonePoints(layers[i].targetPoints),\n        'sourcePoints': clonePoints(layers[i].sourcePoints)\n      });\n    }\n    return layout;\n  };\n\n  var setLayout = function (layout) {\n    for (var i = 0; i < layout.length; i++) {\n      var exists = false;\n      for (var n = 0; n < layers.length; n++) {\n        if (layers[n].element.id == layout[i].id) {\n          console.log('Setting points.');\n          layers[n].targetPoints = clonePoints(layout[i].targetPoints);\n          layers[n].sourcePoints = clonePoints(layout[i].sourcePoints);\n          exists = true;\n        }\n      }\n\n      if (!exists) {\n        var element = document.getElementById(layout[i].id);\n        if (element) {\n          addLayer(element, layout[i].targetPoints);\n        } else {\n          console.log('Maptastic: Can\\'t find element: ' + layout[i].id);\n        }\n      } else {\n        console.log('Maptastic: Element \\'' + layout[i].id + '\\' is already mapped.');\n      }\n    }\n    updateTransform();\n    draw();\n  };\n\n  init();\n\n  // if the config was just an element or string, interpret it as a layer to add.\n\n  for (var i = 0; i < layerList.length; i++) {\n    if ((layerList[i] instanceof HTMLElement) || (typeof (layerList[i]) === 'string')) {\n      addLayer(layerList[i]);\n    }\n  }\n\n  for (var i = 0; i < arguments.length; i++) {\n    if ((arguments[i] instanceof HTMLElement) || (typeof (arguments[i]) === 'string')) {\n      addLayer(arguments[i]);\n    }\n  }\n\n  if (autoLoad) {\n    loadSettings();\n  }\n\n  return {\n    'getLayout': function () {\n      return getLayout();\n    },\n    'setLayout': function (layout) {\n      setLayout(layout);\n    },\n    'setConfigEnabled': function (enabled) {\n      setConfigEnabled(enabled);\n    },\n    'addLayer': function (target, targetPoints) {\n      addLayer(target, targetPoints);\n    }\n  };\n}\n\nexport { Maptastic };\n"],"names":["config","getProp","cfg","key","defaultVal","hasOwnProperty","distanceTo","x1","y1","x2","y2","Math","sqrt","pow","pointInTriangle","point","a","b","c","s","t","A","notifyChangeListener","layoutChangeListener","draw","configActive","context","strokeStyle","lineWidth","clearRect","canvas","width","height","i","layers","length","visible","element","style","visibility","beginPath","hoveringLayer","selectedLayer","moveTo","targetPoints","p","lineTo","closePath","stroke","centerPoint","hoveringPoint","selectedPoint","arc","selectionRadius","PI","showLayerNames","label","id","toUpperCase","font","textAlign","size","measureText","fillStyle","fillRect","fillText","showCrosshairs","mousePosition","showScreenBounds","stepX","stepY","strokeRect","fontSize","round","swapLayerPoints","layerPoints","index1","index2","tx","ty","rotateLayer","layer","angle","sin","cos","px","py","scaleLayer","scale","addLayer","target","document","getElementById","HTMLElement","n","clonePoints","layout","offsetX","offsetLeft","offsetY","offsetTop","position","display","top","left","padding","margin","clientWidth","clientHeight","sourcePoints","push","updateTransform","autoSave","autoLoad","layerList","localStorageKey","dragging","dragOffset","isLayerSoloed","mouseDelta","mouseDownPoint","keyDown","event","keyCode","shiftKey","setConfigEnabled","increment","dirty","delta","altKey","saveSettings","mouseMove","preventDefault","clientX","clientY","cursor","mouseX","mouseY","previousState","previousLayer","mouseUp","mouseDown","localStorage","setItem","JSON","stringify","getLayout","transform","reduce","v","body","l","X","solve","join","enabled","points","clone","slice","resize","window","innerWidth","innerHeight","createElement","zIndex","getContext","appendChild","addEventListener","arguments","getItem","data","parse","loadSettings","exists","console","log","setLayout"],"mappings":"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"}